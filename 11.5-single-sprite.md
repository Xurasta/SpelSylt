# Sprite System - Statiska sprites och tilning

Sprite-systemet erbjuder ett enkelt och modulärt sätt att lägga till statiska sprites till spelobjekt. Sprite-konfigurationen styrs på **level-filnivå**, vilket håller komponenterna frikopplade och återanvändbara.

## Grundläggande koncept

- **Sprite.js** - Rent renderingsverktyg (inga asset-importer)
- **Platform.js** - Accepterar valfri sprite-konfiguration
- **Level-filer** - Importerar assets och skickar sprite-konfiguration till objekt

## Användningsexempel

### 1. Plattform med tilad terräng (full täckning)

```javascript
import terrainSprite from '../assets/Pixel Adventure 1/Terrain/Terrain (16x16).png'

const terrainConfig = {
    image: terrainSprite,
    sourceWidth: 16,
    sourceHeight: 16,
    tile: 'both'  // Tilar i både X och Y
}

new Platform(game, 0, 400, 200, 32, { sprite: terrainConfig })
```

### 2. Plattform med specifik tile från sprite sheet

```javascript
// Terräng-spriten har flera tiles
// Använd tileIndex för att välja en specifik (0-baserad)
const grassConfig = {
    image: terrainSprite,
    sourceWidth: 16,
    sourceHeight: 16,
    tileIndex: 5,  // Välj tile #5 från sheeten
    tile: 'both'
}

new Platform(game, 200, 400, 150, 32, { sprite: grassConfig })
```

### 3. Plattform med manuell source-position

```javascript
// Specificera manuellt vilken tile som ska användas via sourceX/sourceY
const stoneConfig = {
    image: terrainSprite,
    sourceWidth: 16,
    sourceHeight: 16,
    sourceX: 32,   // Börja 32px från vänster
    sourceY: 16,   // Börja 16px från toppen
    tile: 'both'
}

new Platform(game, 400, 400, 100, 32, { sprite: stoneConfig })
```

### 4. Plattform utan sprite (färgad fallback)

```javascript
// Ingen sprite-config = färgad rektangel
new Platform(game, 600, 400, 100, 32, { color: 'blue' })

// Eller utelämna options helt
new Platform(game, 600, 400, 100, 32)  // Använder standard brun färg
```

### 5. Horisontell tilning (upprepa längs X-axeln)

```javascript
// Bra för långa horisontella plattformar
const horizConfig = {
    image: brickSprite,
    sourceWidth: 32,
    sourceHeight: 32,
    tile: 'horizontal'  // Upprepar endast vänster-till-höger
}

new Platform(game, 0, 450, 500, 32, { sprite: horizConfig })
```

### 6. Vertikal tilning (upprepa längs Y-axeln)

```javascript
// Bra för väggar
const wallConfig = {
    image: wallSprite,
    sourceWidth: 16,
    sourceHeight: 16,
    tile: 'vertical'  // Upprepar endast topp-till-botten
}

new Platform(game, 50, 100, 16, 300, { sprite: wallConfig })
```

### 7. Enkel sprite (ingen tilning)

```javascript
// Enkel sprite som sträcks ut för att passa
const boxConfig = {
    image: boxSprite,
    sourceWidth: 32,
    sourceHeight: 32,
    tile: 'none'  // eller utelämna tile-egenskapen
}

new Platform(game, 300, 300, 64, 64, { sprite: boxConfig })
```

### 8. Olika terrängtyper i samma level

```javascript
import terrainSprite from '../assets/Pixel Adventure 1/Terrain/Terrain (16x16).png'

// Gräsplattformar
const grassConfig = { image: terrainSprite, sourceWidth: 16, sourceHeight: 16, tileIndex: 0, tile: 'both' }

// Stenplattformar
const stoneConfig = { image: terrainSprite, sourceWidth: 16, sourceHeight: 16, tileIndex: 5, tile: 'both' }

// Isplattformar
const iceConfig = { image: terrainSprite, sourceWidth: 16, sourceHeight: 16, tileIndex: 10, tile: 'both' }

this.platforms = [
    new Platform(game, 0, 400, 200, 32, { sprite: grassConfig }),
    new Platform(game, 250, 400, 200, 32, { sprite: stoneConfig }),
    new Platform(game, 500, 400, 200, 32, { sprite: iceConfig }),
]
```

## Konfigurationsalternativ

### Sprite Config Object

```javascript
{
    image: string,           // Obligatorisk: importerad bildsökväg
    sourceWidth: number,     // Obligatorisk: tile-bredd i sprite sheet
    sourceHeight: number,    // Obligatorisk: tile-höjd i sprite sheet
    sourceX: number,         // Valfri: X-position i sprite sheet (standard: 0)
    sourceY: number,         // Valfri: Y-position i sprite sheet (standard: 0)
    tile: string,            // Valfri: 'none', 'horizontal', 'vertical', 'both' (standard: 'none')
    tileIndex: number,       // Valfri: vilken tile som ska användas (alternativ till sourceX/Y)
    tilesPerRow: number      // Valfri: för tileIndex-beräkning (autodetekteras om utelämnad)
}
```

### Platform Options Object

```javascript
{
    sprite: object,   // Valfri: sprite-konfiguration (se ovan)
    color: string     // Valfri: fallback-färg (standard: '#8B4513')
}
```

## Best Practices

1. **Definiera sprite-konfigurationer en gång** - Skapa config-objekt och återanvänd dem för flera plattformar
2. **Importera assets på level-nivå** - Håll komponenter frikopplade från specifika assets
3. **Använd meningsfulla variabelnamn** - `grassConfig`, `stoneConfig`, etc.
4. **Tillhandahåll färg-fallbacks** - Användbart för debugging eller om sprites misslyckas ladda
5. **Använd tilning på rätt sätt**:
   - `both` - Plattformar, golv, väggar
   - `horizontal` - Långa horisontella plattformar
   - `vertical` - Vertikala väggar, pelare
   - `none` - Enstaka objekt, dekorationer

## Felsökning

### Sprite visas inte?
- Kontrollera att bildsökvägen är korrekt
- Verifiera att sourceWidth/sourceHeight matchar faktisk tile-storlek
- Kolla webbläsarens konsol för laddningsfel
- Fallback färgad rektangel bör visas under laddning

### Tiles ser fel ut?
- Verifiera tileIndex eller sourceX/sourceY värden
- Kontrollera att tiles i sprite sheet är jämnt utplacerade
- Använd webbläsarens dev tools för att inspektera källbildens dimensioner

### Prestandaproblem?
- Tilning skapar flera draw calls
- För mycket stora ytor, överväg att skapa en enda stor sprite istället
- Använd `tile: 'none'` för mindre objekt
